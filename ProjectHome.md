Imeplement the MS-GSP algorithm